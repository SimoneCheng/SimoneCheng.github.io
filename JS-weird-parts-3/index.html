<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 【克服JS的奇怪部分】Objects and Functions —— Part 1 · 寫字練習</title><meta name="description" content="【克服JS的奇怪部分】Objects and Functions —— Part 1 - Simone Cheng"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/dovefavicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://simonecheng.github.io/atom.xml" title="寫字練習"><meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="寫字練習" type="application/atom+xml">
</head><body><div class="wrap"><header><a class="logo-link" href="/"><img src="/dovefavicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self">BLOG</a></li><li class="nav-list-item"><a class="nav-list-link" href="/tags/" target="_self">TAGS</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self">ARCHIVE</a></li><li class="nav-list-item"><a class="nav-list-link" href="/about/" target="_self">ABOUT</a></li><li class="nav-list-item"><a class="nav-list-link" href="/atom.xml" target="_self">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">【克服JS的奇怪部分】Objects and Functions —— Part 1</h1><div class="post-info">Jun 2, 2022<a class="tag-title" href="/tags/JavaScript/">#JavaScript</a><a class="tag-title" href="/tags/%E5%85%8B%E6%9C%8DJS%E7%9A%84%E5%A5%87%E6%80%AA%E9%83%A8%E5%88%86/">#克服JS的奇怪部分</a></div><aside class="toc"><div class="toc-title"><div class="text">目錄</div><div class="chevron-down-icon"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M207.029 381.476L12.686 187.132c-9.373-9.373-9.373-24.569 0-33.941l22.667-22.667c9.357-9.357 24.522-9.375 33.901-.04L224 284.505l154.745-154.021c9.379-9.335 24.544-9.317 33.901.04l22.667 22.667c9.373 9.373 9.373 24.569 0 33.941L240.971 381.476c-9.373 9.372-24.569 9.372-33.942 0z"/></svg></div></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-Concept-Asides-%E5%90%8D%E8%A9%9E%E8%A7%A3%E9%87%8B"><span class="toc-text">🐳 Concept Asides 名詞解釋</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-Namespace"><span class="toc-text">🦀 Namespace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-First-Class-Function"><span class="toc-text">🦀 First Class Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-Mutate"><span class="toc-text">🦀 Mutate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-Arguments"><span class="toc-text">🦀 Arguments</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-Objects-and-Dot"><span class="toc-text">🐳 Objects and Dot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-Funtcions-are-Objects"><span class="toc-text">🐳 Funtcions are Objects</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-Function-Statements-and-Function-Expressions"><span class="toc-text">🐳 Function Statements and Function Expressions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-Function-Statement-%E6%95%98%E8%BF%B0%E5%BC%8F"><span class="toc-text">🦀 Function Statement 敘述式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-Function-Expression-%E8%A1%A8%E9%81%94%E5%BC%8F"><span class="toc-text">🦀 Function Expression 表達式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-%E5%85%A9%E8%80%85%E4%B9%8B%E9%96%93%E7%9A%84%E5%B7%AE%E5%88%A5"><span class="toc-text">🦀 兩者之間的差別</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-By-Value-and-By-Reference"><span class="toc-text">🐳 By Value and By Reference</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-By-Value"><span class="toc-text">🦀 By Value</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-By-Reference"><span class="toc-text">🦀 By Reference</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-Objects-Funcitons-and-this"><span class="toc-text">🐳 Objects, Funcitons, and this</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%90%B3-%E2%80%98arguments%E2%80%99-and-Spread"><span class="toc-text">🐳 ‘arguments’ and Spread</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-arguments"><span class="toc-text">🦀 arguments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%F0%9F%A6%80-spread"><span class="toc-text">🦀 spread</span></a></li></ol></li></ol></div></aside><div class="post-content"><p>此篇是記錄 Udemy 上面的課程 JavaScript: Understanding the Weird Parts 的筆記。</p>
<span id="more"></span>
<h2 id="🐳-Concept-Asides-名詞解釋">🐳 Concept Asides 名詞解釋</h2>
<h3 id="🦀-Namespace">🦀 Namespace</h3>
<blockquote>
<p>A container for variables and functions.<br>
Typically to keep variables and function with the same name seperate.</p>
</blockquote>
<p>JavaScript 本身並沒有 namespace，但可以透過善用 object 來儲存相同的命名方式，比如用不同的 object 來儲存都叫做 greet 的變數名稱。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> english = &#123; <span class="attr">greet</span>: <span class="string">&quot;Hello!&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> spanish = &#123; <span class="attr">greet</span>: <span class="string">&quot;Hola!&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(english.<span class="property">greet</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(spanish.<span class="property">greet</span>);</span><br></pre></td></tr></table></figure>
<h3 id="🦀-First-Class-Function">🦀 First Class Function</h3>
<blockquote>
<p>Everything you can do with other types you can do with functions.<br>
Assign them to variables, pass them around, create them on the fly.</p>
</blockquote>
<h3 id="🦀-Mutate">🦀 Mutate</h3>
<blockquote>
<p>To change something.<br>
<strong>Immutable</strong> means it can’t be changed.</p>
</blockquote>
<h3 id="🦀-Arguments">🦀 Arguments</h3>
<blockquote>
<p>The parameters you pass to a function.<br>
Jacascript gives you a keyword of the same name which contains them all.</p>
</blockquote>
<h2 id="🐳-Objects-and-Dot">🐳 Objects and Dot</h2>
<p>在前面的影片當中有提到 object 是一對 key、value 的集合，那麼在記憶體當中，object 是如何儲存的呢？</p>
<p>一個 object 裡面的所有 property 會被存在各個記憶體位址，然後 object 所在的記憶體位址則會記得指向其他 property 被保存的記憶體位址。如下圖所示：</p>
<p><img src="../assets/object.png" alt=""></p>
<h2 id="🐳-Funtcions-are-Objects">🐳 Funtcions are Objects</h2>
<p>在 JavaScript 當中 function 就是 object 的一種，所以 function 擁有所有 object 的特性，但同時 function 也有一些自己的特點，例如： function 可以是匿名的，而且 function 有一段自己的 code（可以理解為 function 的其中一個 property 是 code），並且可以透過呼叫 <code>()</code> 來執行。如下圖所示：</p>
<p><img src="../assets/function.png" alt=""></p>
<p>所以其實這樣寫也是行得通的，因為 function 就是 object：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hello!&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">greet.<span class="property">lang</span> = <span class="string">&quot;english&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(greet.<span class="property">lang</span>);</span><br></pre></td></tr></table></figure>
<h2 id="🐳-Function-Statements-and-Function-Expressions">🐳 Function Statements and Function Expressions</h2>
<p>在 JavaScript 當中有兩種方式可以用來宣告 function，分別是：敘述式（function statement）和表達式（function expression）。</p>
<h3 id="🦀-Function-Statement-敘述式">🦀 Function Statement 敘述式</h3>
<p>敘述式的寫法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greeting</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hi&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="🦀-Function-Expression-表達式">🦀 Function Expression 表達式</h3>
<p>表達式的寫法如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> greeting = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hi&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>或是用箭頭函式：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">greeting</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;hi&#x27;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="🦀-兩者之間的差別">🦀 兩者之間的差別</h3>
<p>來看看這兩段程式碼就可以很清楚的知道敘述式和表達式的差別：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hi!&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> greet = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hi!&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>把這兩段程式碼丟去執行的話，可以看到第一個部分的程式碼能夠成功執行並印出 “hi”，因為在使用敘述式時，function 會被 hoisting，所以可以將執行的語法寫在宣告 function 之前。</p>
<p>但是在執行第二部分的程式碼時卻會出錯，因為雖然第二段的程式碼也會進行 hoisting，但被 hoisting 的只有變數本身而已，賦值這個動作並不會被 hoisting，所以在宣吿 greet 之前就呼叫執行它的話， greet 會進入暫時死區並且報錯（因為在這邊使用 const 的關係）。</p>
<p>從這個例子可以知道，敘述式和表達式的最大差別就是在 hoisting 的時候結果會不太一樣，而為了避免可能會產生報錯，盡量都在執行 function 之前先宣吿 function 才是比較好的選擇。</p>
<h2 id="🐳-By-Value-and-By-Reference">🐳 By Value and By Reference</h2>
<h3 id="🦀-By-Value">🦀 By Value</h3>
<p>目前有下列的程式碼：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>; <span class="comment">// primitive value</span></span><br><span class="line">b = a;</span><br></pre></td></tr></table></figure>
<p>如果 a 這個變數的值是一個 primitive type（例如數字、字串、布林值等等）的話，當我們將 a 賦值給 b 的時候，其實是會將 a 的值複製出一個新的，然後將它儲存在另外一個新的記憶體區塊，再把新的記憶體區塊 reference 到 b，如下圖所示：</p>
<p><img src="../assets/byvalue.png" alt=""></p>
<h3 id="🦀-By-Reference">🦀 By Reference</h3>
<p>接下來以下面的程式碼範例為例，來舉例什麼是 <strong>by reference</strong>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123; <span class="attr">firstName</span>: <span class="string">&#x27;John&#x27;</span>, <span class="title class_">LastName</span>: <span class="string">&#x27;Walker&#x27;</span> &#125;;</span><br><span class="line"><span class="keyword">const</span> b = a;</span><br><span class="line"></span><br><span class="line">b.<span class="property">firstName</span> = <span class="string">&#x27;Ben&#x27;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b.<span class="property">firstName</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a.<span class="property">firstName</span>); <span class="comment">// a.firstName 會印出什麼？</span></span><br></pre></td></tr></table></figure>
<p>從上述程式碼中可以知道，我們將 a 這個變數指向一個 object，然後再將 b 指向 a，最後去修改 b 這個 object 裡面的 property，但結果卻發現 a 裡面的 property 也被我們修改到了，也就是說我們不管是修改 b 或是修改 a 都會修改到同一個 object。</p>
<p>為什麼會發生上述這件事呢？是因為當資料型態是 reference type (object, array…) 的時候，JavaScript 是透過 <strong>by reference</strong> 去傳遞參數的，也就是如下圖所示：</p>
<p><img src="../assets/byreference.png" alt=""></p>
<p>其實 a 和 b 這兩個變數都指向同一個記憶體區塊（也就是 object 的所在位置），所以不管是透過 a 或 b 來修改 object，都是修改到同樣的東西。</p>
<div class="info">
<p>ℹ️ <strong>小小結論</strong><br>
知道 <strong>by value</strong> 和 <strong>by reference</strong> 的差別，有助於程式開發和除錯。在這邊會討論到 <strong>by value</strong> 和 <strong>by reference</strong> 的差別主要是因為，當我們在進行程式開發或是除錯的時候，會需要處理非常多各式各樣的資料型態。當如果不小心改動的原本的資料時，可能會導致某些 function 出錯，此時知道 <strong>by value</strong> 和 <strong>by referenct</strong> 的差異可以更好的去避免改動到原始資料，降低產生 bug 的機率！</p>
</div>
<h2 id="🐳-Objects-Funcitons-and-this">🐳 Objects, Funcitons, and <code>this</code></h2>
<p>前面的幾部影片有提到 function 在執行的時候，會有一個 funciton 自己的 execute content 和 variable environment，並透過 scope chain 去拿到 outer environment 的變數，除此之外還會有一個東西——叫做 <code>this</code>，接下來這個部分會特別針對 <code>this</code> 來做說明。</p>
<p>首先，先來看看幾個簡單的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">a</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">a</span>();</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> b = <span class="title function_">funciton</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">b</span>();</span><br></pre></td></tr></table></figure>
<p>如果我們將上述三個程式碼放到瀏覽器當中去執行的話，可以知道這三個印出來的東西都是 window，也就是說，按照上面的方式（寫在 function 當中然後直接執行，或是直接執行）去呼叫 <code>this</code>，它所指向的東西都是 window 這個 global object。</p>
<p>接下來我們試試用在 object 裡面建立 method 的方式來呼叫 <code>this</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> c = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;The c object&#x27;</span>,</span><br><span class="line">    <span class="attr">log</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">c.<span class="title function_">log</span>();</span><br></pre></td></tr></table></figure>
<p>當我們將上述的程式碼丟到瀏覽器的環境中執行時， <code>this</code> 會印出 c 這個 object，也就是說透過一個 object 來呼叫其中的 method 的話，此時的 <code>this</code> 會指向該 object。接下來我們繼續看看下一個範例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> c = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;The c object&#x27;</span>,</span><br><span class="line">    <span class="attr">log</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> setName = <span class="keyword">function</span>(<span class="params">newName</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">name</span> = newName;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setName</span>(<span class="string">&#x27;Update c object!&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">c.<span class="title function_">log</span>();</span><br></pre></td></tr></table></figure>
<p>按照上上一個程式碼範例的認知，如果在一個 object method 裡面呼叫 <code>this</code>，那麼 <code>this</code> 就會指向該 object，但當我們執行 <code>c.log()</code> 之後，裡面的 <code>setName</code> function 似乎並沒有成功地幫我們將 <code>c.name</code> 修改成新的名字。反而在 window 這個 global object 下面，找到了 <code>window.name === 'Update c object'</code>。也就是說 <code>setName</code> function 裡面的 <code>this</code> 是指向 window，並不是指向 object c。</p>
<p>為了要讓 <code>this</code> 能夠一直指向 object c，我們可以把程式碼修改成下面這樣：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> c = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;The c object&#x27;</span>,</span><br><span class="line">    <span class="attr">log</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> self = <span class="variable language_">this</span>; <span class="comment">// 多加這一行，然後所有的 this 都改用 self</span></span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(self);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> setName = <span class="keyword">function</span>(<span class="params">newName</span>) &#123;</span><br><span class="line">            self.<span class="property">name</span> = newName;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setName</span>(<span class="string">&#x27;Update c object!&#x27;</span>);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(self);</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">c.<span class="title function_">log</span>();</span><br></pre></td></tr></table></figure>
<p>只要將 <code>this</code> 賦值給一個變數後，然後在其他所有有用到 <code>this</code> 的地方都改用該變數， 這樣寫在 <code>c.log()</code> 裡面的任何 function 都能夠透過 scope chain 去找到該變數指向的 <code>this</code> 了（也就是 object c）。</p>
<div class="info">
<p>ℹ️ <strong>小小結論</strong><br>
如果在 function 裡面呼叫 <code>this</code>，然後在 global 當中執行，通常 <code>this</code> 會指向 window，如果是呼叫放在 object 當中的 function 的話，呼叫的 <code>this</code> 則會指向該 object，但如果是在 object 的 function 中還有另一個內部的 function，這個內部的 function 呼叫的 <code>this</code> 會指向 window，為了避免這樣的 bug，可以先在 object function 裡面的最上方將 <code>this</code> 賦值給某個變數（通常會寫成 <code>const self = this</code>）。</p>
</div>
<h2 id="🐳-‘arguments’-and-Spread">🐳 ‘arguments’ and Spread</h2>
<h3 id="🦀-arguments">🦀 arguments</h3>
<p>在開始說明什麼是 <code>arguments</code> 之前，我們先來看一個普通的 function：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">firstName, lastName, language</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(language);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;----------&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">greet</span>();</span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>);</span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>);</span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;en&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>在上述的 function 當中，雖然 <code>greet()</code> 這個 function 需要傳三個變數進去，但如果少傳了任何一個，Javascript 並不會報錯，而是會將沒有傳入任何值的變數預設成 <code>undefined</code>。而這樣的特性也就表示，可以很簡單的對一個變數設置一個預設值，比如，如果沒有傳 <code>language</code> 這個變數進去的話，先將其預設值設成 <code>'en'</code>，可以這樣寫：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">firstName, lastName, language = <span class="string">&#x27;en&#x27;</span></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(language);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;----------&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或是比較舊的寫法：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">firstName, lastName, language</span>) &#123;</span><br><span class="line">    language = language || <span class="string">&#x27;en&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(language);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;----------&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在一個 function 當中，除了傳進去的變數之外，Javascript 也提供了一個稱作 <code>arguments</code> 的變數來接收傳進來的所有變數。此時我們可以來把上述的 function 改造一下，將 <code>arguments</code> 加進去，然後看看會發生什麼事情：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">firstName, lastName, language</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(language);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>); <span class="comment">// 將 Javascript 內建的 arguments 加入</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;----------&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">greet</span>();</span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>);</span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>);</span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;en&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p>可以看到執行四遍的 <code>greet()</code> 分別印出了以下四個不同的 <code>arguments</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[]</span><br><span class="line">[&#x27;John&#x27;]</span><br><span class="line">[&#x27;John&#x27;, &#x27;Doe&#x27;]</span><br><span class="line">[&#x27;John&#x27;, &#x27;Doe&#x27;, &#x27;en&#x27;]</span><br></pre></td></tr></table></figure>
<p>從印出的結果當中可以知道 <code>arguments</code> 是一個可以收集所有傳進 function 的變數的類 array，為什麼會說它是類 array 是因為它長得很像 array，可以做到一些跟 array 很像的事情，但 array 的某些特性它沒有。</p>
<p>這時候我們就可以用 <code>arguments</code> 來做一些事情，比如可以檢查有沒有變數傳進來，如果沒有就報錯：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">firstName, lastName, language</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Missing parameters&#x27;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(language);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">arguments</span>); <span class="comment">// 將 Javascript 內建的 arguments 加入</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;----------&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="🦀-spread">🦀 spread</h3>
<p>spread 簡單來說就是很常看到的 <code>...</code>。而這個 <code>...</code> 實際上有什麼用途呢？目前我所知道的用法主要有三個：</p>
<ol>
<li>如果傳入某個 function 的變數可能是OO個和OO個以上，這個「以上」的部分可以用 <code>...</code> 包起來。</li>
<li>可以用來解構 array。</li>
<li>可以用來解構 object。</li>
</ol>
<p>廢話不多說，直接用實際的例子來看看：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">firstName, lastName, language, ...others</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(lastName);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(language);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(others);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">greet</span>(<span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;Doe&#x27;</span>, <span class="string">&#x27;en&#x27;</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure>
<p>在上述的例子，可以看到 <code>others</code> 這個變數印出了 [1, 2, 3, 4]，這也就是說它將 <code>firstName, lastName, language</code> 之外的值都包在 <code>others</code> 這個 array 裡面，這也就是表示這個 function 可以傳入三個或三個以上的值。</p>
<p>接著來看看解構的例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr1 = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>];</span><br><span class="line"><span class="keyword">const</span> arr2 = [...arr1];</span><br></pre></td></tr></table></figure>
<p>在上述程式碼中，可以透過 <code>...</code> 拿到 arr1 裡面的每個元素，然後再把它放到 arr2 來達到淺拷貝。用在 object 當中也是同樣的道理。如此一來便可以輕鬆達到淺拷貝。</p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/git-basic-1/">PREV</a><a class="next" href="/JS-weird-parts-2/">NEXT</a></div><div class="copyright"><p>© 2021 - 2024 <a href="https://simonecheng.github.io">Simone Cheng</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/achjqz/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script type="text/javascript" id="maid-script" src="https://unpkg.com/mermaid@10.3.1/dist/mermaid.min.js?v=undefined"></script><script>if (window.mermaid) {
  var options = JSON.parse(document.getElementById('maid-script').getAttribute('mermaidoptioins'));
  mermaid.initialize(options);
}
</script><script>const tocTitleElement = document.querySelector('.toc-title');
const tocContentElement = document.querySelector('.toc-content');
if (tocTitleElement) {
  tocTitleElement.addEventListener('click', (e) => {
    const isActive = tocContentElement.classList.contains('active') || tocTitleElement.classList.contains('active');
    if (isActive) {
      tocContentElement.classList.remove('active');
      tocTitleElement.classList.remove('active');
    } else {
      tocContentElement.classList.add('active');
      tocTitleElement.classList.add('active');
    }
  });
}</script></body></html>